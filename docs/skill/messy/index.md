# æ‚ä¸ƒæ‚å…«

## è·å–ä¸­é—´ä½ç½®

- ä½¿ç”¨é™¤ä»¥äºŒç„¶åå†å–æ•´çš„æ–¹æ³•

  - ç—›ç‚¹ä¸€ï¼šæœ€å°å€¼ä¸æœ€å¤§å€¼çš„å’Œæœ‰å¯èƒ½è¶…å‡ºæ•°å­—çš„ç²¾åº¦èŒƒå›´ã€‚
  - ç—›ç‚¹äºŒï¼šå¿…é¡»è°ƒç”¨æ•°å­¦æ–¹æ³•è¿›è¡Œå–æ•´ã€‚

  ```ts
  const low = 0,
    high = 10;
  const mid = Math.floor((low + high) / 2);
  ```

- ä½¿ç”¨ä½è¿ç®—

  - ç—›ç‚¹ä¸€ï¼šæœ€å°å€¼ä¸æœ€å¤§å€¼çš„å’Œæœ‰å¯èƒ½è¶…å‡ºæ•°å­—çš„ç²¾åº¦èŒƒå›´ã€‚
    - åŸç†æ˜¯å› ä¸ºå³ç§» 1 ä½åï¼ŒäºŒè¿›åˆ¶æ•°æœ€åä¸€ä½çš„ç²¾åº¦ä¸¢å¤±å¯¼è‡´è‡ªåŠ¨å‘ä¸‹å–æ•´ï¼Œè§£å†³äº†éœ€è¦è°ƒç”¨æ•°å­¦æ–¹æ³•çš„ç—›ç‚¹ã€‚

  ```ts
  const low = 0,
    high = 10;
  const mid = (low + high) >> 1;
  ```

- ä½¿ç”¨ä½è¿ç®—å¹¶è§£å†³ low + high è¶…å‡ºå®‰å…¨è¡¨ç¤ºèŒƒå›´çš„åœºæ™¯ã€‚
  - è§£å†³äº†ä¸Šè¿°çš„ä¸¤ä¸ªç—›ç‚¹ï¼Œä¸Šè¿°ç—›ç‚¹äºŒè§£å†³åŸç†ä¸å†èµ˜è¿°ï¼Œç—›ç‚¹ä¸€çš„è§£å†³æ€è·¯æ˜¯ï¼Œæ—¢ç„¶ low ä¸ high å„è‡ªéƒ½æ²¡æœ‰è¶…å‡ºç²¾åº¦èŒƒå›´ï¼Œé‚£ä¹ˆ high- low å¿…å®šæ²¡æœ‰è¶…å‡ºç²¾åº¦èŒƒå›´ï¼Œè¿™ä¸ªå€¼çš„ä¸€åŠä¹Ÿæ˜¯åŒç†ï¼Œä½¿ç”¨ low + è¿™ä¸ªå€¼çš„ä¸€åŠå¿…å®šä¸ä¼šå¤§äº highï¼Œå› æ­¤è¡¨ç¤ºæ˜¯å®‰å…¨çš„ã€‚
  ```ts
  const low = 0,
    high = 10;
  const mid = low + ((high - low) >> 1);
  ```

## æ€§èƒ½ä¼˜åŒ–

### å›¾ç‰‡æ ¼å¼ä¸ä½“ç§¯ä¼˜åŒ–

- åœ¨ web ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç²¾çµå›¾ä¹Ÿå«é›ªç¢§å›¾é…åˆ css çš„ background-position è¿›è¡ŒèƒŒæ™¯å®šä½ï¼Œè¿™æ ·å­å¯ä»¥åœ¨æœ¬æ¥éœ€è¦åŠ è½½å¤šå¼ å°å›¾çš„åœºæ™¯åªåŠ è½½ä¸€å¼ å›¾ï¼Œç„¶åé€šè¿‡èƒŒæ™¯å®šä½çš„æ–¹å¼å®šä½åˆ°å½“å‰éœ€è¦å±•ç¤ºçš„å›¾ç‰‡ä½ç½®è¿›è¡Œå±•ç¤ºã€‚
  - ä¼˜ç‚¹ï¼šå‡å° http å¹¶å‘è¯·æ±‚æ•°é‡ï¼ŒåŠ å¿«äº†å›¾ç‰‡èµ„æºçš„å±•ç¤ºã€‚ï¼ˆç”±å¤šå¼ å›¾ä¸‹è½½å®Œæˆæ‰èƒ½å…¨éƒ¨å±•ç¤ºå˜ä¸ºåªéœ€è¦ä¸‹è½½ä¸€å¼ å›¾å³å¯ï¼‰ã€‚
  - ç¼ºç‚¹ï¼šä¿®æ”¹ç²¾çµå›¾ä¸­å•ä¸ªå›¾çš„æ—¶å€™éœ€è¦æ•´ä½“æ›¿æ¢åŸæ¥å›¾ç‰‡ï¼Œå¦‚æœæ–°çš„å›¾ç‰‡ä½ç½®å¤§å°æœ‰è°ƒæ•´ï¼Œæ•´ä½“çš„å›¾ç‰‡éœ€è¦æŒ¨ä¸ªè°ƒæ•´ä½ç½®ï¼Œä½¿å…¶æ­£å¸¸å±•ç¤ºï¼Œä¸æ–¹ä¾¿ã€‚
- å°†å›¾ç‰‡è¿›è¡Œå‹ç¼©ï¼Œæ¨èä½¿ç”¨[tiny](https://tinify.cn/)ç½‘ç«™è¿›è¡Œå›¾ç‰‡å‹ç¼©ï¼Œå¯å¤§å¤§å‡å°å›¾ç‰‡ä½“ç§¯ï¼ŒåŠ å¿«å›¾ç‰‡åŠ è½½é€Ÿåº¦ã€‚
- ä¼˜åŒ–å›¾ç‰‡æ ¼å¼ï¼š
  - ç®€å•ä»‹ç»ä¸‹ä¸‹åˆ—å›¾ç‰‡æ ¼å¼ï¼š
    - jpgï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œå±•ç¤ºè‰²å½©ä¸°å¯Œçš„å›¾ç‰‡ï¼Œå…¶ä¸­æ²¡æœ‰ alpha é€šé“ï¼Œå› æ­¤ä¸èƒ½å±•ç¤ºé€æ˜åƒç´ ï¼Œé€æ˜åƒç´ ä¼šé»˜è®¤æ¸²æŸ“ä¸ºç™½è‰²åº•ï¼Œåœ¨æ²¡æœ‰é€æ˜åƒç´ çš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥æ ¼å¼ç›¸æ¯”äºå…¶ä»–æ ¼å¼å¯ä»¥å‡å°å›¾ç‰‡ä½“ç§¯ï¼ŒåŠ å¿«å›¾ç‰‡åŠ è½½é€Ÿåº¦ã€‚
    - pngï¼Œå¯ä»¥ç”¨æ¥å±•ç¤ºå¸¦æœ‰é€æ˜åƒç´ çš„å›¾ç‰‡ï¼Œè¯¥æ ¼å¼å³ä½¿åœ¨å‹ç¼©åä¹Ÿä¸ä¼šå¯¼è‡´ä»»ä½•æ–‡ä»¶è´¨é‡çš„æŸå¤±ã€‚æ”¯æŒå›¾åƒé€æ˜åº¦ï¼Œå¹¶æä¾›æ¯” GIF æ›´å¥½çš„è´¨é‡ã€‚è¯¥æ ¼å¼å…·æœ‰ 256 çº§ä¸é€æ˜åº¦ï¼Œä»å®Œå…¨ä¸é€æ˜åˆ°å®Œå…¨é€æ˜ä¸ç­‰ï¼›è¯¥æ ¼å¼é€‚åˆäºå­˜å‚¨å›¾åƒçš„å³æ—¶ç‰ˆæœ¬ï¼Œå› ä¸ºé‡æ–°ä¿å­˜ä¸ä¼šå¯¼è‡´è´¨é‡æŸå¤±ï¼›è¯¥æ ¼å¼æ”¯æŒå¹¿æ³›çš„é¢œè‰²èŒƒå›´ï¼›ä¸é€‚åˆå…¨å½©è‰²å›¾åƒçš„å±•ç¤ºã€‚
    - gifï¼Œå¤šç”¨æ¥åˆ›å»ºåŠ¨å›¾ï¼Œæ”¯æŒ alpha é€šé“ï¼Œå¯å±•ç¤ºé€æ˜åƒç´ ï¼Œå›¾ç‰‡ä½“ç§¯æ¯” png è¾ƒå¤§ã€‚
    - webpï¼Œä¸ png æ ¼å¼ç±»ä¼¼ï¼Œä½†æ˜¯å…¶ä½“ç§¯è¿œå°äº png æ ¼å¼ï¼Œç¼ºç‚¹æ˜¯æµè§ˆå™¨æ”¯æŒæ€§è¾ƒå·®ï¼Œå°¤å…¶æ˜¯åœ¨ ios13 ä»¥ä¸‹ï¼Œä¸æ”¯æŒ webp æ ¼å¼å±•ç¤ºã€‚
  - è‰²å½©ä¸°å¯Œçš„å›¾ç‰‡ä½¿ç”¨ jpg æ ¼å¼ï¼Œç›¸æ¯”äºå…¶ä»–æ ¼å¼ä½“ç§¯æ›´å°ã€‚
  - æœ‰é€æ˜åƒç´ çš„å›¾ç‰‡ä½¿ç”¨ png æ ¼å¼ï¼Œå¦‚æœå¯¹åªéœ€è¦æ”¯æŒæ–°ç‰ˆç°ä»£æµè§ˆå™¨å¯ä½¿ç”¨ webp æ ¼å¼ä¼˜åŒ–å›¾ç‰‡ä½“ç§¯ã€‚
  - åŠ¨å›¾å¯ä½¿ç”¨ gif æ ¼å¼ï¼Œgif æ ¼å¼å¯¹åŠ¨å›¾çš„æ”¯æŒæ€§ä»¥åŠæµè§ˆå™¨çš„å…¼å®¹æ€§éƒ½ç›¸å½“ä¸é”™ã€‚

### å›¾ç‰‡é¢„åŠ è½½

- åœ¨å·¥ä½œä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å›¾ç‰‡é¢„åŠ è½½æ¥å¯¹å›¾ç‰‡å±•ç¤ºè¿›è¡Œä¼˜åŒ–ï¼Œåˆ©ç”¨åŠ è½½åçš„ç¼“å­˜æ¥å‡å°åç»­å›¾ç‰‡åŠ è½½æ—¶é—´ã€‚
- æˆ‘ä»¬å¯ä»¥åœ¨ web ä¸­é€šè¿‡åˆ›å»ºå›¾ç‰‡çš„æ–¹å¼`new Image()`ï¼Œåœ¨ä½¿ç”¨å›¾ç‰‡ä¹‹å‰é¢„å…ˆå¯¹å›¾ç‰‡è¿›è¡ŒåŠ è½½ï¼ŒåŠ è½½åçš„å›¾ç‰‡ä¼šç¼“å­˜åœ¨å®¢æˆ·ç«¯ï¼Œåœ¨éœ€è¦ç”¨åˆ°è¯¥å›¾ç‰‡çš„ä½ç½®å±•ç¤ºæ—¶ä¼šç›´æ¥è¯»å–ç¼“å­˜çš„å›¾ç‰‡ï¼Œå¤§å¤§å‡å°å›¾ç‰‡åç»­åŠ è½½å›¾ç‰‡å¼•èµ·çš„é¡µé¢é—ªçƒä¸æ—¶é—´ã€‚
  - ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹ï¼šå¦‚ web çš„æ¸¸æˆç•Œé¢ï¼Œå¼€å§‹å‰éœ€è¦è¯» loading çš„è¿›åº¦æ¡ï¼Œå…¶å®è¿™ä¸ªæ—¶å€™æ˜¯åœ¨åŠ è½½åç»­ç”¨åˆ°çš„å›¾ç‰‡ï¼Œä½¿åç»­åŠ è½½æ—¶é¡µé¢ä¸­çš„å›¾ç‰‡å¯ä»¥åšåˆ°ç§’å¼€ï¼Œå¢å¼ºç”¨æˆ·ä½“éªŒã€‚
- ä¼˜ç‚¹ï¼š
  - å¤§å¤§å‡å°åç»­å›¾ç‰‡ä¸Šå±æ—¶åŠ è½½æ€ä¸å®Œæˆæ€çš„è½¬æ¢è¿‡ç¨‹å¯¹ç”¨æˆ·çš„å¯è§åº¦ï¼Œå¢å¼ºäº†ç”¨æˆ·ä½“éªŒï¼Œä½†æœ¬è´¨ä¸Šè¿˜æ˜¯éœ€è¦åŠ è½½å…¨éƒ¨å›¾ç‰‡ï¼Œåªæ˜¯ç›¸å½“äºæŠŠåç»­åŠ è½½éœ€è¦çš„æ—¶é—´è¿›è¡Œäº†æå‰ï¼Œå¯ä»¥ä½¿ç”¨å¹¶å‘æ¥åŠ å¿«å›¾ç‰‡åŠ è½½ï¼Œå¦‚æœç”¨æˆ·æµè§ˆå®Œå…¨éƒ¨å›¾ç‰‡é¡µé¢æ€»ä½“æ—¶é—´ä¼šå‡å°ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ­¤ä½¿ç”¨ä¸€ä¸ªè¿›åº¦æ¡æˆ–æ˜¯ç™¾åˆ†æ¯” loading å¯¹ç”¨æˆ·å±•ç¤ºå½“å‰è¿›åº¦ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚
- ç¼ºç‚¹ï¼š
  - è¿˜æ˜¯éœ€è¦å¯¹å›¾ç‰‡è¿›è¡ŒåŠ è½½ï¼Œæœ¬è´¨ä¸Šæ˜¯å¯¹å›¾ç‰‡çš„åŠ è½½æ—¶é—´è¿›è¡Œäº†æå‰ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰æµè§ˆé¢„åŠ è½½å›¾ç‰‡é¡µé¢è¿˜æ˜¯éœ€è¦ä»˜å‡ºå…¨éƒ¨é¢„åŠ è½½çš„æ—¶é—´ï¼›
  - å¦‚æœç”¨æˆ·æ²¡æœ‰æµè§ˆå®Œå…¨éƒ¨é¢„åŠ è½½é¡µé¢ï¼Œé‚£ä¹ˆå°±å¢å¤§äº† http å›¾ç‰‡è¯·æ±‚é‡ï¼Œç™½ç™½æµªè´¹å‰é¢ http çš„è¯·æ±‚ä¸ç”¨æˆ·æ—¶é—´ã€‚

### å›¾ç‰‡æ‡’åŠ è½½

- å›¾ç‰‡æ‡’åŠ è½½æ˜¯åœ¨å³å°†ç”¨åˆ°å›¾ç‰‡æ—¶å€™æå‰è¿›è¡ŒåŠ è½½ï¼Œä¸ç”¨ä¸€æ¬¡æ€§åŠ è½½å¤šä¸ªå›¾ç‰‡ï¼Œå¯ä»¥ç†è§£ä¸ºå»¶è¿ŸåŠ è½½ã€‚
- ä¸é¢„åŠ è½½çš„åŒºåˆ«ï¼šé¢„åŠ è½½æ˜¯æå‰è¿›è¡ŒæŸä¸€åœºæ™¯å…¨éƒ¨å›¾ç‰‡çš„åŠ è½½ï¼Œé¿å…ç”¨æˆ·çœ‹åˆ°åç»­å›¾ç‰‡ä¸Šå±å¼•èµ·é¡µé¢ä¸­å›¾ç‰‡çš„åŠ è½½æ€ä¸å®Œæˆæ€çš„è½¬æ¢ï¼›æ‡’åŠ è½½æ˜¯å³å°†è¦å¯¹ç”¨æˆ·å±•ç¤ºè¯¥å›¾ç‰‡æ—¶ï¼Œå†è¿›è¡ŒåŠ è½½ï¼Œå¦‚æœç”¨æˆ·ç”¨ä¸åˆ°è¿™ä¸ªå›¾ç‰‡å°±ä¸è¿›è¡ŒåŠ è½½ï¼Œä¸€ä¸ªæ˜¯é¢„å…ˆåŠ è½½ä¸€ä¸ªæ˜¯å»¶è¿ŸåŠ è½½ï¼Œæ‡’åŠ è½½å¤šç”¨åœ¨åˆ—è¡¨é¡µï¼Œå¯¹åˆ—è¡¨é¡µé¢ä¸­çš„å›¾ç‰‡è¿›è¡Œæ‡’åŠ è½½ã€‚
- ä¼˜ç‚¹ï¼š
  - ç”¨åœ¨åˆ—è¡¨é¡µï¼Œå¦‚æœç”¨æˆ·åªæµè§ˆäº†ä¸€å±çš„å›¾ç‰‡é‚£ä¹ˆå°±ä¸éœ€è¦å¯¹æ•´ä¸ªåˆ—è¡¨çš„å›¾ç‰‡è¿›è¡ŒåŠ è½½ï¼Œå‡å°äº† http çš„å¹¶å‘æµé‡ã€‚
- ç¼ºç‚¹ï¼š
  - å› ä¸ºå»¶è¿ŸåŠ è½½äº†å›¾ç‰‡ï¼Œç½‘ç»œæ¡ä»¶å·®çš„æƒ…å½¢ä¸‹æœ‰æ—¶ç”¨æˆ·ä¼šçœ‹åˆ°å›¾ç‰‡çš„åŠ è½½æ€ä¸å®Œæˆæ€çš„è½¬æ¢ï¼Œä½†ä¸€èˆ¬åœ¨ç±»ä¼¼åœºæ™¯ä¸­éƒ½æ˜¯å¯æ¥å—çš„ã€‚
- å®ç°æ–¹æ¡ˆï¼š
  ä¸€èˆ¬æ¥è¯´æœ‰ä¸¤ç§å®ç°æ–¹æ¡ˆå¦‚ä¸‹ï¼š
  - ç¬¬ä¸€ç§æ˜¯é¦–å…ˆä¸å°†å›¾ç‰‡åœ°å€æ”¾ç½®åˆ°å›¾ç‰‡å…ƒç´ çš„ `src` å±æ€§ï¼Œä¾‹å¦‚å¯ä»¥ä½¿ç”¨ `data-src` å±æ€§æ¥æš‚æ—¶å­˜å‚¨å›¾ç‰‡çš„åœ°å€ï¼Œç„¶åç›‘å¬åˆ—è¡¨é¡µ`container`çš„æ»šåŠ¨äº‹ä»¶ï¼ˆ`scroll`,`wheel`,`mousewheel`,`resize`,`animationend`,`transitionend`,`touchmove`ï¼‰ï¼Œç„¶åä½¿ç”¨å…ƒç´ çš„`getClientRects()`æˆ–`getBoundingClientRect()`æ–¹æ³•æ¥è·å–å›¾ç‰‡å…ƒç´ è·ç¦»è§†å£çš„ä½ç½®ï¼Œåˆ¤æ–­åˆ°è¾¾æŸä¸ªé˜ˆå€¼åå°†`data-src`æ”¾ç½®åˆ°å›¾ç‰‡çš„`src`å±æ€§ä¸Šè¿›è¡ŒåŠ è½½å›¾ç‰‡ï¼Œä»¥æ­¤æ¥è¾¾åˆ°å›¾ç‰‡åŠ è½½çš„æ•ˆæœã€‚æ³¨æ„åœ¨åŠ è½½å®Œæˆåå³å¯é”€æ¯è¯¥å…ƒç´ å¯¹äºä½ç½®çš„ç›‘å¬ã€‚
  - ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨ web çš„ æ–° api [intersectioObserver](https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API)æ¥å¯¹å›¾ç‰‡å…ƒç´ è¿›è¡Œä½ç½®ç›‘å¬ï¼Œç„¶ååœ¨è¿›å…¥å±å¹•æˆ–æ˜¯æŸä¸€ä¸ªé˜ˆå€¼è¿›è¡Œå¯¹å›¾ç‰‡å…ƒç´ çš„`src`èµ‹å€¼ã€‚
  - ç¬¬ä¸€ç§æ–¹æ³•å…¼å®¹æ€§æ›´åŠ ä¼˜è‰¯ï¼Œç¬¬äºŒç§æ–¹æ³•å®ç°èµ·æ¥æ›´åŠ ç®€å•ï¼ŒæŒ‰éœ€ä½¿ç”¨å³å¯ã€‚

### é¡µé¢å¼‚æ­¥æ¸²æŸ“å¤§é‡æ•°æ®

å‡è®¾æˆ‘ä»¬å½“å‰çš„é¡µé¢æœ‰å¤§é‡çš„æ•°æ®è¿›è¡Œä¸Šå±ï¼Œæ¯”å¦‚æœ‰ 10000 è¡Œè¡¨æ ¼å†…å®¹ï¼Œå› ä¸º js æ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚æœæˆ‘ä»¬ä¸€æ¬¡æ€§ä¸Šå±çš„è¯é¡µé¢ä¼šå‡æ­»ï¼ˆå¡ä½ï¼‰ï¼Œæ— æ³•å“åº”ç”¨æˆ·äº‹ä»¶ï¼Œç”¨æˆ·ä½“éªŒæå·®ï¼Œä½†æ˜¯æˆ‘ä»¬åˆæœ‰å¦‚æ­¤å¤šçš„æ•°æ®éœ€è¦ä¸Šå±é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š

- ä½¿ç”¨å®šæ—¶å™¨å¼‚æ­¥æ¸²æŸ“ dom
  - å› ä¸ºå®šæ—¶å™¨æ˜¯å¼‚æ­¥çš„å®ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®šæ—¶å™¨å¼‚æ­¥è¿›è¡Œé¡µé¢æ¸²æŸ“ï¼Œè¿™æ ·å°±ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹å¯¹äºç”¨æˆ·äº‹ä»¶çš„å“åº”ï¼Œå¯ä»¥æå‡ç”¨æˆ·ä½“éªŒã€‚ä½†æ˜¯è¯¥æ–¹æ³•æœ‰ä¸ªç¼ºç‚¹ï¼Œå¦‚æœç”¨æˆ·çš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿çš„è¯ï¼Œé‚£ä¹ˆå®šæ—¶å™¨ä¼šä¸€ç›´å»¶åè¿›è¡Œæ‰§è¡Œï¼Œå¯¹äºç”¨æˆ·æ¥è¯´ä»ç„¶ä¼šæœ‰é¡µé¢å¡é¡¿æ— æ³•å“åº”ç”¨æˆ·äº‹ä»¶çš„åœºæ™¯ã€‚
- ä½¿ç”¨æµè§ˆå™¨çš„ api [requestAnimationFrame](https://developer.mozilla.org/zh-CN/docs/Web/API/window/requestAnimationFrame)æ¥è¿›è¡Œå¼‚æ­¥æ¸²æŸ“ï¼Œè¯¥ api æ˜¯æµè§ˆå™¨ç”¨æ¥ç»˜åˆ¶åŠ¨ç”»çš„ï¼Œæ‰§è¡Œé¢‘ç‡éšç€æµè§ˆå™¨çš„åˆ·æ–°é¢‘ç‡å˜åŒ–ï¼Œåœ¨é«˜åˆ·æ–°ç‡çš„å±å¹•ä¸Šè¯¥æ–¹æ³•ä¼šæ‰§è¡Œçš„æ›´å¿«ï¼Œä¸€èˆ¬ä¸º 16.7ms æ‰§è¡Œä¸€æ¬¡ã€‚åœ¨è¿™ä¸ªæ–¹æ³•çš„å›è°ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ dom è¿›è¡Œæ“ä½œï¼Œä»¥æ­¤è¾¾åˆ°å¼‚æ­¥æ›´æ–°çš„æ•ˆæœï¼Œè¯¥ api åœ¨æ³¨å†Œä¹‹åä¸ä¼šè¢«ç”¨æˆ·çš„åŒæ­¥ä»»åŠ¡æ‰€é˜»å¡ï¼Œè¯¥ api æœ€ä½æ”¯æŒ IE10 å…¼å®¹æ€§ä¹Ÿç›¸å½“ä¸é”™ã€‚

### æ¥å£æ•°æ®åˆ†æ‰¹ä¸Šå±

å½“æˆ‘ä»¬ä½¿ç”¨ Vue æˆ–æ˜¯ React æ—¶ï¼Œè™½ç„¶ç•Œé¢æ˜¯å·²ç»æ˜¯å¼‚æ­¥æ›´æ–°ï¼Œä½†æ˜¯å¦‚æœåœ¨ä¸€æ¬¡çš„`setState`ä¸­å¦‚æœæ›´æ–°å¤§é‡çš„ dom èŠ‚ç‚¹é‚£ä¹ˆå¯¹äºæµè§ˆå™¨æ¥è¯´é¡µé¢çš„æ¸²æŸ“å‹åŠ›è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ€æ ·ä¼˜åŒ–å‘¢ï¼Ÿ

- åœ¨ React çš„ç±»ç»„ä»¶ä¸­æˆ‘ä»¬çŸ¥é“`setState`çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª callbackï¼Œè¿™ä¸ª callback åœ¨ dom æ›´æ–°åä¼šè°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æ•°æ®åˆ†æ‰¹ä¸Šå±æ¸²æŸ“æ¥é™ä½é¡µé¢çš„é¦–å±æ¸²æŸ“å‹åŠ›ï¼ŒåŠ å¿«é¦–å±æ¸²æŸ“é€Ÿåº¦ã€‚

- useEffect ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åéƒ½æ‰§è¡Œå—ï¼Ÿ æ˜¯çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¹‹åå’Œæ¯æ¬¡æ›´æ–°ä¹‹åéƒ½ä¼šæ‰§è¡Œã€‚ï¼ˆæˆ‘ä»¬ç¨åä¼šè°ˆåˆ°å¦‚ä½•æ§åˆ¶å®ƒã€‚ï¼‰ä½ å¯èƒ½ä¼šæ›´å®¹æ˜“æ¥å— effect å‘ç”Ÿåœ¨â€œæ¸²æŸ“ä¹‹åâ€è¿™ç§æ¦‚å¿µï¼Œä¸ç”¨å†å»è€ƒè™‘â€œæŒ‚è½½â€è¿˜æ˜¯â€œæ›´æ–°â€ã€‚React ä¿è¯äº†æ¯æ¬¡è¿è¡Œ effect çš„åŒæ—¶ï¼ŒDOM éƒ½å·²ç»æ›´æ–°å®Œæ¯•ï¼Œå¯ä»¥åœ¨é’©å­ä¸­è¿›è¡Œæ›´æ–°ã€‚

  - hooks å‰¯ä½œç”¨è°ƒç”¨å¦‚ä¸‹ï¼š

    ```ts
    useEffect(() => {
      // è¿™é‡Œä¼šåœ¨domæ›´æ–°ç»“æŸä¹‹åè°ƒç”¨
    }, [ä¾èµ–]);
    ```

  ğŸ“¢ï¼šæ³¨æ„ä¸€å®šè¦æœ‰é€€å‡ºæ¡ä»¶ï¼Œé¿å…æ— é™é€’å½’è°ƒç”¨ã€‚

- Vue ä¸­çš„ watch é’©å­ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹ï¼š

  - å½“ä½ æ›´æ”¹äº†å“åº”å¼çŠ¶æ€ï¼Œå®ƒå¯èƒ½ä¼šåŒæ—¶è§¦å‘ Vue ç»„ä»¶æ›´æ–°å’Œä¾¦å¬å™¨å›è°ƒã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç”¨æˆ·åˆ›å»ºçš„ä¾¦å¬å™¨å›è°ƒï¼Œéƒ½ä¼šåœ¨ Vue ç»„ä»¶æ›´æ–°ä¹‹å‰è¢«è°ƒç”¨ã€‚è¿™æ„å‘³ç€ä½ åœ¨ä¾¦å¬å™¨å›è°ƒä¸­è®¿é—®çš„ DOM å°†æ˜¯è¢« Vue æ›´æ–°ä¹‹å‰çš„çŠ¶æ€ã€‚å¦‚æœæƒ³åœ¨ä¾¦å¬å™¨å›è°ƒä¸­èƒ½è®¿é—®è¢« Vue æ›´æ–°ä¹‹åçš„ DOMï¼Œä½ éœ€è¦æŒ‡æ˜ flush: 'post' é€‰é¡¹ï¼š

  ```ts
  watch(source, callback, {
    flush: 'post',
  });
  watchEffect(callback, {
    flush: 'post',
  });
  ```

  - åç½®åˆ·æ–°çš„ watchEffect() æœ‰ä¸ªæ›´æ–¹ä¾¿çš„åˆ«å watchPostEffect()ï¼š

  ```ts
  import { watchPostEffect } from 'vue';

  watchPostEffect(() => {
    /_ åœ¨ Vueç»„ä»¶ æ›´æ–°åæ‰§è¡Œ _/;
  });
  ```

  ğŸ“¢ï¼šæ³¨æ„ä¸€å®šè¦æœ‰é€€å‡ºæ¡ä»¶ï¼Œé¿å…æ— é™é€’å½’è°ƒç”¨ã€‚

æ•°æ®åˆ†æ‰¹ä¸Šå±ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šæ–‡æåˆ°çš„`requestAnimationFrame`è¿›è¡Œä¸‹ä¸€å¸§ä¸Šå±ï¼Œå¯ä»¥å‡å°é¡µé¢é¦–å±é¦–å¸§çš„æ¸²æŸ“å‹åŠ›ã€‚

## è®¾ç½®è¾ƒå°å­—å·ï¼ˆå°äº 12pxï¼‰çš„å­—ä½“

web ä¸­å¯è®¾ç½®çš„å­—ä½“å¤§å°æœ€å°ä¸º 12pxï¼Œæ— æ³•è®¾ç½®å°äº 12px çš„å­—ä½“ï¼Œç›®å‰å¤§å¤šæ•°å®ç°å°å­—å·çš„å­—ä½“æœ‰ä»¥ä¸‹å¸¸ç”¨ä¸¤ä¸ªæ–¹æ¡ˆ

- ä»¥æˆ‘ä»¬éœ€è¦è®¾ç½® 9px çš„å­—ä½“ä¸ºä¾‹

### ä½¿ç”¨ transform ç¼©æ”¾

```css
.ninepx-div {
  font-size: 12px;
  transform: scale(0.75);
  color: red;
}
```

æˆ‘ä»¬å¯ä»¥è®¾ç½®å­—ä½“å¤§å°ä¸º 12px ç„¶åä½¿ç”¨`transform:scale(0.75)`æ¥è®©æˆ‘ä»¬çš„å…ƒç´ è¿›è¡Œç¼©æ”¾ 3/4 ä»¥è¾¾åˆ°æˆ‘ä»¬çš„ 9pxï¼Œä½†æ˜¯è¯¥æ–¹æ¡ˆæœ‰ä¸ªç¼ºç‚¹å°±æ˜¯å…ƒç´ çš„ä½“ç§¯ä¼šå¡Œé™·ï¼Œå³ç›’å­çš„å¤§å°ä¼šä¸€èµ·ç¼©æ”¾ï¼Œä¸ä¼šåªç¼©æ”¾å­—ä½“ã€‚

### ä½¿ç”¨å­—ä½“çš„ size-adjust å±æ€§

```css
@font-face {
  font-family: ninepx;
  src: url('xxxx.ttf') format('truetype');
  size-adjust: 75%;
}
.ninepx-div {
  font-size: 12px;
  font-family: ninepx;
  color: red;
}
```

æˆ‘ä»¬å¼•å…¥å­—ä½“ï¼Œç„¶åè®¾ç½® size-adjust ç¼©æ”¾æ¯”ä¾‹ï¼Œåœ¨æˆ‘ä»¬éœ€è¦ç¼©æ”¾çš„æ–‡å­—ä¸Šé¢æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥å­—ä½“ï¼Œç„¶åè®¾ç½®ç›¸åº”çš„ 12px å³å¯ï¼Œå› ä¸ºç¼©æ”¾æ¯”ä¾‹ä¸º 3/4 æ‰€ä»¥å½“æˆ‘ä»¬è®¾ç½® 12px æ—¶ï¼Œè¯¥å­—ä½“çš„å±•ç¤ºå¤§å°å°±æ˜¯ 9pxï¼Œè¯¥æ–¹æ¡ˆçš„å¥½å¤„æ˜¯ä¸ä¼šé€ æˆç›’å­çš„å¡Œé™·ï¼Œç›’å­å¤§å°ä¸ä¼šè¿›è¡Œç¼©æ”¾ï¼Œåªä¼šç¼©æ”¾å­—ä½“ã€‚

## è®¾è®¡æ¨¡å¼

### å•ä¾‹æ¨¡å¼

```ts
// å•ä¾‹æ¨¡å¼
class Person {
  static instance: Person;
  constructor(public name) {
    if (Person.instance) {
      return Person.instance;
    }
    Person.instance = this;
  }
  sayHello() {
    console.log(`hello ,æˆ‘çš„åå­—æ˜¯${this.name}`);
  }
}
```

### è§‚å¯Ÿè€…æ¨¡å¼ã€å‘å¸ƒè®¢é˜…

```ts
class PubAndSub {
  map = new Map<string, Set<(data: any) => void>>();
  subscribe(event: string, callback: (data: any) => void) {
    if (!this.map.has(event)) {
      this.map.set(event, new Set());
    }
    const dep = this.map.get(event)!;
    dep.add(callback);
  }
  publish(event: string, data: any) {
    if (this.map.has(event)) {
      const dep = this.map.get(event)!;
      dep.forEach(callback => {
        callback(data);
      });
    }
  }
  remove(event: string, callback?: (data: any) => void) {
    if (this.map.has(event)) {
      const dep = this.map.get(event)!;
      if (callback) {
        if (dep.has(callback)) {
          dep.delete(callback);
        }
      } else {
        dep.clear();
      }
    }
  }
  removeAll() {
    this.map.clear();
  }
}
```
